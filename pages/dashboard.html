<!DOCTYPE html>
<html lang="en">

<div class="row mt-4 clientDiv">
    <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card ">
            <div class="card-header pb-0 p-3">
                <div class="d-flex justify-content-between">
                    <h6 class="mb-2">Serviço de Quarto</h6>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table align-items-center ">
                    <tbody class="roomServicesTableBody">


                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4 clientDiv">
    <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card ">
            <div class="card-header pb-0 p-3">
                <div class="d-flex justify-content-between">
                    <h6 class="mb-2">Estadia</h6>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table align-items-center ">
                    <tbody class="reservesTableBody">



                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


<div class="row mt-4 employeeDiv">
    <div class="col-lg-12 mb-lg-0 mb-4">
        <div class="card ">
            <div class="card-header pb-0 p-3">
                <div class="d-flex justify-content-between">
                    <h6 class="mb-2">Tarefas</h6>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table align-items-center ">
                    <tbody class="tasksTableBody">



                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

</html>

<script>

    var dashboard = {

        getClientDashBoardInitialData: function () {

            $.ajax({
                url: "http://127.0.0.1:8080/getClientDashBoardInitialData",
                type: "POST",
                contentType: "application/json",
                data: contentHub.userInfo.user.id,
                success: function (data) {

                    var htmlToAppend = "";

                    if (data.roomServiceList.length == 0){
                        htmlToAppend = '<div style="text-align: center; margin-top: 10vh; margin-bottom: 10vh;">SEM SERVIÇOS DE QUARTO</div>';
                    }else{
                        $.each(data.roomServiceList, function( index, value ) {
                            htmlToAppend += '<tr>\n' +
                                '                        <td class="w-10">\n' +
                                '                            <div class="d-flex px-2 py-1 align-items-center">\n' +
                                '                                <div><span class="material-symbols-outlined">add</span></div>\n' +
                                '                                <div class="ms-4" style="margin-left: 2rem !important;">\n' +
                                '                                    <p class="text-xs font-weight-bold mb-0">Produto:</p>\n' +
                                '                                    <h6 class="text-sm mb-0">' + value.nome + '</h6>\n' +
                                '                                </div>\n' +
                                '                                </div>\n' +
                                '                            </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Quantidade:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.quantidade + '</h6>\n' +
                                '                                </div>\n' +
                                '                            </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Preço:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.preco.toFixed(2) + '€</h6>\n' +
                                '                                </div>\n' +
                                '                            </td>\n' +
                                '                        </tr>';
                        });
                    }

                    $(".roomServicesTableBody").html(htmlToAppend);

                    htmlToAppend = "";

                    if (data.reserveList.length == 0){
                        htmlToAppend = '<div style="text-align: center; margin-top: 10vh; margin-bottom: 10vh;">SEM ESTADIAS</div>';
                    }else{
                        $.each(data.reserveList, function( index, value ) {
                            htmlToAppend += '<tr>\n' +
                                '                        <td class="w-10">\n' +
                                '                            <div class="d-flex px-2 py-1 align-items-center">\n' +
                                '                                <div><span class="material-symbols-outlined">add</span></div>\n' +
                                '                                <div class="ms-4" style="margin-left: 2rem !important;">\n' +
                                '                                    <p class="text-xs font-weight-bold mb-0">Reserva:</p>\n' +
                                '                                    <h6 class="text-sm mb-0">' + value.numero + '</h6>\n' +
                                '                                </div>\n' +
                                '                            </div>\n' +
                                '                        </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Nº Quarto:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.idQuarto + '</h6>\n' +
                                '                            </div>\n' +
                                '                        </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Data Início:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.dataInicio + '</h6>\n' +
                                '                            </div>\n' +
                                '                        </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Data Fim:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.dataFim + '</h6>\n' +
                                '                            </div>\n' +
                                '                        </td>\n' +
                                '                        <td>\n' +
                                '                            <div class="text-center">\n' +
                                '                                <p class="text-xs font-weight-bold mb-0">Preço:</p>\n' +
                                '                                <h6 class="text-sm mb-0">' + value.preco.toFixed(2) + '€</h6>\n' +
                                '                            </div>\n' +
                                '                        </td>\n' +
                                '                    </tr>';
                        });
                    }

                    $(".reservesTableBody").html(htmlToAppend);

                },
                error: function (data) {
                    debugger;
                    //$(".roomServiceCardBody").html('<div class="col-md-12" style="text-align: center; margin-top: 5vh; margin-bottom: 5vh;"><span>SEM RESERVAS</span></div>');
                }
            });
        },

        getEmployeeDashBoardInitialData: function () {

            $.ajax({
                url: "http://127.0.0.1:8080/getEmployeeDashBoardInitialData",
                type: "POST",
                contentType: "application/json",
                data: contentHub.userInfo.user.id,
                success: function (data) {

                    var htmlToAppend = "";
                    var count = 0;

                    if (data.tasks.length == 0){
                        htmlToAppend = '<div style="text-align: center; margin-top: 10vh; margin-bottom: 10vh;">SEM TAREFAS</div>';
                    }else{
                        $.each(data.tasks, function( index, value ) {
                            if (count <= 4) {
                                htmlToAppend += '<tr>\n' +
                                    '                        <td class="w-10">\n' +
                                    '                            <div class="d-flex px-2 py-1 align-items-center">\n' +
                                    '                                <div><span class="material-symbols-outlined">add</span></div>\n' +
                                    '                                <div class="ms-4" style="margin-left: 2rem !important;">\n' +
                                    '                                    <p class="text-xs font-weight-bold mb-0">Utilizador:</p>\n' +
                                    '                                    <h6 class="text-sm mb-0">' + contentHub.userInfo.user.userName + '</h6>\n' +
                                    '                                </div>\n' +
                                    '                                </div>\n' +
                                    '                            </td>\n' +
                                    '                           <td>\n' +
                                    '                            <div class="text-center">\n' +
                                    '                                <p class="text-xs font-weight-bold mb-0">Título:</p>\n' +
                                    '                                <h6 class="text-sm mb-0">' + value.title + '</h6>\n' +
                                    '                                </div>\n' +
                                    '                            </td>\n' +
                                    '                        <td>\n' +
                                    '                            <div class="text-center">\n' +
                                    '                                <p class="text-xs font-weight-bold mb-0">Descrição:</p>\n' +
                                    '                                <h6 class="text-sm mb-0">' + value.description + '</h6>\n' +
                                    '                                </div>\n' +
                                    '                            </td>\n' +
                                    '                        <td>\n' +
                                    '                            <div class="text-center">\n' +
                                    '                                <p class="text-xs font-weight-bold mb-0">Data:</p>\n' +
                                    '                                <h6 class="text-sm mb-0">' + moment(value.dateTime).format('DD/MM/YYYY HH:mm:ss') + '</h6>\n' +
                                    '                                </div>\n' +
                                    '                            </td>\n' +
                                    '                        </tr>';
                                count++;
                            }
                        });

                    }

                    $(".tasksTableBody").html(htmlToAppend);

                },
                error: function (data) {
                    debugger;
                    //$(".roomServiceCardBody").html('<div class="col-md-12" style="text-align: center; margin-top: 5vh; margin-bottom: 5vh;"><span>SEM RESERVAS</span></div>');
                }
            });
        },

    };

    $(document).ready(function () {

        if (contentHub.userInfo.user.isClient){
            dashboard.getClientDashBoardInitialData();
            $(".employeeDiv").remove();
        }else{
            dashboard.getEmployeeDashBoardInitialData();
            $(".clientDiv").remove();
        }
    });


</script>